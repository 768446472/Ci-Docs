# CI-C22GS02S模块数据手册

## 模块介绍

### 概述

启英泰伦单麦离线语音识别模组是针对离线低成本、简单应用方案开发的一款通用、便携、低功耗高性能语音识别模组，型号CI-C22GS02S 主芯片为CI1122。支持识别100条及以下数量命令词。该模组只需要采用单颗麦克风就可以实现10米超远距离语音识别，并且识别率能达到97%以上。该模组具有2路UART，3路PWM。

![模块框图](img/CI-C22GS02S模块数据手册-1.png){: .center }

<div align=center>图2  模块框图</div>

◆ 模组体积小巧，长宽为18x20mm，方便集成到各种智能产品中，支持SMD贴片和插针两种安装方式，设计和生产均比较灵活方便。

◆ 模组功耗低，可以应用到有能耗等级要求的产品和电池类产品中，模组运行功耗≤150mW。

◆ 低成本，该模组为低成本人工智能神经网络专用语音识别模组，给客户产品带来了超高性价比。

◆ 高性能，单麦克风方案实现超高识别率，超远距离识别，单麦降噪。

◆ 高可靠性，模组选材均选用工业级器件，通过了包括双85高温高湿测试在内的多项可靠性实验，可应用在对可靠性要求极高的家电产品中。

◆ 扩展性良好，通过2路UART，可以扩展wifi、bt、2.4G、433、zigbee等通讯接口实现联网需求，通过3路PWM可以直接控制灯光，红外等外设。

<div align=center>表1 模块选型表</div>

<center>

模块选型 | 本地命令词200条 
:--: | :--: 
带插口单麦离线语音模块 | CI-C22GS02S

</center>

### 模块主芯片介绍

CI1122是一颗专用于语音处理的人工智能芯片，可广泛应用于家电、家居、照明、玩具、穿戴设备、汽车等产品领域，实现语音交互及控制。CI1122内置自主研发的脑神经网络处理器BNPU，支持本地语音识别，和内置的CPU核结合可以做各类智能语音方案应用。

CI1122内置高性能低功耗Audio Codec模块。同时该芯片还集成多路UART、IIC、PWM、GPIO等外围控制接口，可以开发低成本的单芯片智能语音离线识别方案。

CI1122芯片功能框图如图1所示:

![芯片功能框图](img/CI-C22GS02S模块数据手册-7.png){: .center }

<div align=center>图1  芯片功能框图</div>

想了解CI1122芯片更多的详细信息，请点击以下链接:

☞[CI1122芯片数据手册](../芯片数据手册/CI1122芯片数据手册/芯片概述.md)


### 模块功能描述

◆ 远场识别

可以支持10米远距离的正常语音识别，该模组采用的单麦方案可以实现任意角度识别，无识别死角。

◆ 单麦降噪

模组可以在噪音环境下正常识别，对环境自然噪声能很好地抑制，对新闻、音乐等噪声有较好适应能力。

◆ 固件开发便捷

客户通过启英泰伦语音AI平台快速定制生成语音指令，或制作固件用于烧录调试和测试。

◆ 大音量播音

模组设计有播音功放，支持1W功放输出。

### 模块应用场景

该模块可用作语音识别前端+客户硬件主控板方案组合使用，也可以作为灯具、玩具等方案的单芯片主控模块。应用时需外接麦克风和喇叭，并通过外部接入的5V电源进行供电。

![模块作为语音识别前端应用示意图](img/CI-C22GS02S模块数据手册-12.png){: .center }

<div align=center>图2  模块作为语音识别前端应用示意图</div>

CI-C22GS02S模块支持100条以内的离线语音识别命令词，可以用来做电风扇、取暖桌、晾衣机、小家电、玩具、照明等对命令词要求较少的产品。

![模块可应用的产品](img/CI-B0XGS01J模块数据手册-3.png){: .center }

<div align=center>图3  模块可应用的产品</div>

## 模块规格

### 模块尺寸图

![模块尺寸图](img/CI-C22GS02S模块数据手册-2.png){: .center }

<div align=center>图3  模块尺寸图</div>

如图3所示，用户可根据此尺寸设计结构。

### 模块硬件接口定义

![模块引脚图](img/CI-C22GS02S模块数据手册-3.png){: .center }

<div align=center>图4  模块引脚图</div>

模块全部对外引脚的功能描述如表2所示：

<div align=center>表2 模块引脚对照表</div>

<center>

管脚号|	管脚名称|	I/O类型|IO驱动能力|	IO上电默认状态	|  功能定义
:--: | :--: | :--: | :--: | :--: | :--:
1 | 3.3V | p | - | - | 3.3V电源输出，note1 
2 | PWM3 | IO，T+D | 4mA | IN，T+D | 1.PWM输出通道 2.GPIO[18]2_2
3 | PWM4 | IO，T+D | 4mA | IN，T+D | 1.PWM输出通道4 2.GPIO2_3[19]，note2 I2C1_SDA
4 |	PWM5 | IO，T+D | 4mA |- | 1.PWM输出通道5 2.GPIO2_4[20]，note2 I2C1_SCL
5 |	GND	| P | - | - | 地信号
6 |	RX0	| IO，T+U | 4mA | IN，T+U	| 1.UART0_RX 2.GPIO01_7[1]
7 |	TX0	| IO，T+U | 4mA | IN，T+U	| 1.UART0_TX 2.GPIO2_0[0]
8 |	5V | P | - | - | 5V电源 |
9 |	PG_ENMCLK| IO，T+D | 4mA | - | 1.UART_UPDATE_EN引脚，与板上PG_EN脚短接，上电默认高电平，进入UART升级模式2.I2S1_MCLK Note2IIS_TESTSPI1_CLK
10|	TX1|IO，T+U	| 4mA | IN，T+U | 1.UART1_TXI2C1_SDA 2.GPIO2_7[23]
11|	RX1|IO，T+U	| 4mA | IN，T+U | 1.UART1_RXI2C1_SCL 2.GPIO3_0[24]
12|	MICL-| - | - | - |麦克风负极
13|	MICL+| - | - | - |麦克风正极
14|	SKPL-| - | - | - |喇叭输出
15|	SKPL+| - | - | - |喇叭输出
16|	GND	 | P | - | - |地信号
17|	5V	 | P | - | - |5V电源

</center>

***note1：3.3v输出电流不超过50mA。***

***Note2：该脚复用两种功能，在上电的时候系统会检测该脚的电平，为高电平进入升级模式，功能为UART_UPDATE_EN，上电后该脚功能为I2S1_MCLK,输出MCLK信号。***

上表中的一些符号的说明如下：

I		input

O		output

IO		bidirectional

P		power or ground

T+D		tristate plus pull-down 

T+U		tristate plus pull-up

OUT		power-on defaults to output mode

## 电路设计参考
### 电源
5V电源通过8脚和17脚电源接口输入到模组，5V电压经过LDO降压为3.3V电压供模组3.3V使用，5V通过DCDC降压为1.2V。模组主控要3.3V、1.2V两种电源才能工作，功放芯片采用5V电源供电。模组供电5v输入需要添加一个稳压管和一个TVS管。
### PWM
模组有3路PWM输出，分别为PWM3、PWM4、PWM5，可以直驱LED灯和红外发射，具体应用参照表2。
### ESD设计
因为CI1122芯片ESD等级较高并且模组设计为方便用户扩展，所有模组上没有设计ESD器件，对与ESD很高要求的产品可以在底板的接口位置添加ESD器件，包括麦克风、喇叭、UART接口、电源等（详情请咨询我司技术支持人员）。
### GPIO
模组板所有IO都可以配置为GPIO，模组板一共8个GPIO，所有GPIO都是3.3V电平，与不兼容电平的系统对接必须进行电平转换，可参考图5。
### UART
UART为3.3V电平，UART为高速串口，与不兼容电平的系统对接需要进行电平转换，可参考图5。

![电平转换参考电路图](img/CI-C22GS02S模块数据手册-4.png){: .center }

<div align=center>图5  电平转换参考电路图</div>

### 底版设计参考

![底版设计参考](img/CI-C22GS02S模块数据手册-5.png){: .center }
![底版设计参考](img/CI-C22GS02S模块数据手册-6.png){: .center }
<div align=center>图6  底版设计参考</div>


### 模块电气特性参数

<div align=center>表3 模块引脚对照表</div>

<center>

参数 | 条件 | 最小值 | 典型值 | 最大值 | 单位 | 备注
:--: | :--: | :--: | :--: | :--: | :--: | :--:
模块供电电压 | / | 4.5 | 5 | 5.5 | V | NOTE1
模块播音状态电流（正常音量） | 8欧2W喇叭 | / | 70 | / | mA | NOTE2
模块工作电流 | / | / | 40 | / | mA | NOTE3
安静环境下监听状态电流 | 5V供电 | / | 29 | / | mA | /
芯片IO接口电压 | / | 3 | 3.3 | 3.6 | V | /

</center>

***NOTE1：5V为模块典型供电电压，输入超过5.5V电压会损坏模块。***

***NOTE2：模块播音状态下最大电流能达到250mA，按照两倍余量原则上需要为模块提供一组驱动能力为500mA的电源供电。***

***NOTE3：典型值测试时为静音状态。最大值测试时为识别并播音状态。***

### 模块温湿度参数

<div align=center>表4 温湿度参数表</div>

<center>

参数 | 最小值 | 典型值 | 最大值 | 单位 | 备注
:--: | :--: | :--: | :--: | :--: | :--:
模块工作环境温度 | -20 | 25 | 85 | °C | /
模块存储环境温度 | -20 | 25 | 100 | °C | /
模块存储湿度 | 0% | / | 5% | RH |  /

</center>

## 使用注意事项

（1）5V供电需保证500mA的额定供电电流，要求电源稳定，纹波在30mV以内，模组板1脚和20脚均需要接5V电源供电。模组供电5v输入需要添加一个稳压管和一个TVS管。 

（2）此模组板的所有IO均为3.3V电平，如果需要接 5V或2.5V逻辑电平，必须加转接电路。

（3）通讯接口部分可以串联一个小电阻，如22R。

（4）可以将模组上的喇叭和麦克风设计连接到主板插座。

（5）FLASH_PG_EN为升级选择，调试使用时可焊接排针，使用跳线帽分别与中间排针短接使用。

（6）UART0_TX和UART0_RX信号需要设计到底板插针上，通过UART0进行固件升级。

（7）模组底板设计的时候请注意，5V电源输入处增加电容，麦克风走线尽量短；麦克风走线要注意屏蔽，SPK走线尽量短而粗，走线区域不得有其它走线跨跃。

（8）控制底板翘曲程度不大于0.5%，防止模组焊接不良。

（9）客户在检验、焊接生产过程中需佩戴防静电手环，或防静电手套、指套。在对应底板连接器位置请预留 ESD 防护器件，保障产品的质量可靠性。

## 模块应用

### 模块上电及启动

使用该模块时，接上喇叭和麦克风，应将5V电源通过电源座子输入到模块，模块通电后会启动，上电正常喇叭会播报提示音频，此时UART口会有打印信息出现，用户可以将该UART口用USB串口调试助手等工具接到电脑上，在电脑中的串口调试软件中看到打印信息后表明模块启动成功，如图3-1所示。注意模块的UART接口为5V电平高速串口，与5V电平的系统对接不再需要进行电平转换。

输入模块的5V电源会经过模块上的LDO和DCDC芯片降压为3.3V和1.2V，供主芯片使用。模块上的功放芯片采用5V电源供电。5V供电需保证500mA的额定供电电流，要求电源稳定，纹波在30mV以内。

![模块启动后的一个参考打印信息](img/CI-B0XGS01J模块数据手册-7.png){: .center }

<div align=center>图7  模块启动后的一个参考打印信息</div>

### 模块默认命令词

如果为用户量产模块，一般出厂前会烧录用户指定的命令词条固件。如果客户未指定，模块会自带默认固件，该固件带默认命令词，供用户测试使用，其命令词如下图所示：

![模块默认命令词](img/CI-B0XGS01J模块数据手册-8.png){: .center }

<div align=center>图8  模块默认命令词</div>

### 模块默认串口通讯协议

本模块默认的固件中支持串口通讯协议，用于和上位机的通讯使用。该串口协议可扩展，有以下特点:

* 完整传输包，包含：头尾，长度，校验，消息类型，消息序列号。
* 支持变长命令，方便扩展。
* 消息类型(命令，通知，回复)。
* 命令消息，可配置，回复ACK。通知消息无ACK。
* 消息格式将与bootloader升级的相同，通过header来与bootloader协议区分。
* 默认波特率使用9600。
* 注意：模块只预留UART0接口，UART0接口默认为打印输出接口。如需UART0作为上述串口协议接口，必须修改代码，修改方式可参照☞[CI1122芯片SDK](../../软件开发/SDK/CI112X芯片SDK/CI112X芯片SDK.md) 的串口协议部分文档实现。
* 支持的命令：查询协议版本号，查询系统版本号，设置音量（音量分级在user_config.h中定义），播放本地播报音，复位命令等，具体协议格式如下图所示：

![串口协议格式](img/CI-B0XGS01J模块数据手册-9.png){: .center }

<div align=center>图9  串口协议格式</div>

**举例说明1：**

A5 FC 07 00 A0 91 18 01 55 E0 01 00 00 1B 9B 02 FB解析如下，

A5 FC：head

07 00:有效数据为7byte

A0 ：这是命令词信息

91 ：命令号码为0x91（本次数据内容为命令词数据）

18 ：包序号，本串口第0x08次外发数据，该数值不断累加

01 55 E0 01 00 00：当前命令词的唯一数据

1B ：命令词阈值

9B 02：累加和 

FB：结尾数据

备注：如果应用中仅关注命令词和阈值，则只关注蓝色部分的7个有效数据就可以了。

**举例说明2：**

A5 FC 02 00 A3 9A 17 00 B1 05 02 FB 解析如下：

A5 FC ：head

02 00：有效数据2byte

A3 ：当前为通知数据

9A ：命令号码为0X9A（本次数据内容为语音模块内容改变）

17 ：本串口第0x07次外发数据，该数值不断累加

00 B1：有效数据。（本数据表示进入唤醒状态）

05 02：累加和

FB：结尾数据

备注：改数据为通知数据，用户根据情况选择使用该信息。

更多的内容解析数据可以可参照☞[CI1122芯片SDK](../../软件开发/SDK/CI112X芯片SDK/CI112X芯片SDK.md) 中的串口协议部分。下图为一个协议数据参考截图：

![串口协议数据参考截图](img/CI-B0XGS01J模块数据手册-10.png){: .center }

<div align=center>图10  串口协议数据参考截图</div>

### 软件开发

如果模块自带的默认固件无法满足用户需求，用户可以自行进行软件开发，修改该模块的命令词、播报音、串口通讯协议以及其他功能。

软件开发流程主要包含以下几个步骤：

* SDK开发包资料下载
* 模型制作（语言模型+声学模型）
* 语音合成
* 命令词信息表与音频文件关联
* 固件打包

详细开发流程请点击☞[CI1122芯片SDK](../../软件开发/SDK/CI112X芯片SDK/CI112X芯片SDK.md)  了解。

### 固件烧录

#### 烧录前准备工作

用户要烧录模块前，需要准备以下物品：

* 待烧录的模块
* USB转串口工具
* 固件烧录工具（pack_update_tool.exe）
* 固件信息（*.bin格式的文件）
* 2.0mm间距麦克风
* 2.5mm间距喇叭
* 杜邦线若干

![固件烧录需准备的物品](img/CI-B0XGS01J模块数据手册-11.png){: .center }

<div align=center>图11  固件烧录需准备的物品</div>

#### 硬件连接并烧录

使用USB TYPE-C 转接线连接模块和电脑.如果没有上述底板,则需要USB转串口工具,如上图的USB转串口工具所示，在烧录前需要先将USB转串口的电源、地、串口收发引脚分别和模块对应的引脚连接起来，（注意USB转串口的RXD和TXD分别对应模块的UART0_TX和UART0_RX），接着，短接模块的PG_EN和旁边的引脚（模块的背面有相关的丝印，可根据丝印提示查找相关的位置）。模块烧录的接线图、以及模块背面的丝印图如下图所示。

![模块和USB转串口工具连接](img/CI-C22GS02S模块数据手册-9.png){: .center }

<div align=center>图12  模块和USB转串口工具连接</div>

打开固件烧录工具（该工具可以在SDK开发包中CI110X_SDK\tools目录找到PACK_UPDATE_TOOL.exe），根据芯片选择对应的型号，点击固件升级按钮，选择制作好的固件文件，并找到对应的电脑分配给USB转串口工具的串口端口号。准备工作就绪后，通过瞬间上电时短接PG_EN和旁边的引脚（拉高PG_EN管脚的电平）进入编程模式，此时可下载固件。如果遇到USB转串口工具在电脑上无法识别，请在电脑装上相应的驱动。

![固件烧录工具示意图](img/CI-B0XGS01J模块数据手册-13.png){: .center }

<div align=center>图13  固件烧录工具示意图</div>

#### 烧录后功能测试

固件烧录成功后，建议对模块进行功能测试，以验证烧录固件是否成功。功能测试时给待测模块插上麦克风以及喇叭，通电观察是否能正常上电播报，同时用唤醒词和命令词测试是否能正常唤醒和识别，如果均能正常工作，则模块功能正常，烧录成功；否则，烧录失败，需进一步探其原因。

### 使用中可能出现的问题和解决方法

本章节列举了一些模块使用中可能遇到的问题和对应的解决方法。

1. 模块不能烧录并更新固件。
出现上述问题后，请检查以下操作点：
    1. 模块上电前是否已拉高PG_EN管脚（按上文3.5.2节描述和旁边的管脚短接）；
    2. 串口管脚是否接对，TX和RX是否有接反，电脑端USB转串口工具驱动是否正常，PC端烧录工具是否选择了正确的串口号；
    3. 如以上两点检查无误后，模块还不能烧录，需要使用万用表测量模块供电电压5V、3.3V、1.2V是否正确，用示波器测量晶体是否起振，频率是否为12.288Mhz。各个硬件测量点参考下图。如果发现有电压或晶体出问题，考虑为模块硬件故障，请更换模块或针对模块硬件进行维修。如上述检查均无问题，请联系我司技术支持人员获取帮助。

![模块测试点分布图](img/CI-C22GS02S模块数据手册-8.png){: .center }

<div align=center>图14  模块测试点分布图</div>

2. 模块烧录完成，上电后无播报。
出现上述问题后，请检查以下操作点：
    1. 确认烧录固件是否与板子匹配；
    2. 确认喇叭正确接好，供电正常；
采用示波器测量主芯片的语音输出测试点。无输出需检查请固件是否正确，有输出需检查模块上的功放期间是否焊接出现异常，如果功放有异常可更换后再测试。测量点如下图。如上述检查均无问题，请联系我司技术支持人员获取帮助。

![模块语音输出测量点](img/CI-C22GS02S模块数据手册-10.png){: .center }

<div align=center>图15  模块语音输出测量点</div>

3. 模块烧录完成，上电后有播报但是不识别命令词：
    1. 检查麦克风和插口的连接是否完好；
    2. 检查麦克风正负极方向是否与模块板上标示一致，没有插反；
    3. 使用万用表测量主芯片对应的MICBIAS管脚是否为2.8V左右电压，使用示波器测量麦克风输入管脚是否有输入语音波形（示波器每格电压调整为100mv档位），若信号正常需考虑固件是否正确，若信号异常需观察板子硬件是否有物理损伤。测量点如下图。如上述检查均无问题，请联系我司技术支持人员获取帮助。

![模块麦克风信号测试点](img/CI-C22GS02S模块数据手册-11.png){: .center }

<div align=center>图16  模块麦克风信号测试点</div>

### 其它应用注意事项

因为CI1122芯片ESD等级较高并且模块设计为方便用户扩展，所以模块上只在麦克风位置设计ESD器件，对与ESD很高要求的产品可以再添加ESD器件。建议用户在检验、焊接生产过程中佩戴防静电手环或防静电手套、指套。在对应底板连接器位置请预留 ESD 防护器件，保障产品的质量可靠性。 

使用时注意麦克风、喇叭、电源串口不能接错，注意防止背面测试点短路。

注意本模块串口是5V供电，请使用5V电平的串口进行通讯。用户可采用USB转串口工具对开发的软件进行调试，调试时需在SDK软件中相应位置加上串口打印命令，编译后生成固件并烧录，就可以进行调试验证。

## 生产指南、存储和包装订购信息

### 生产指南

该模块因采用带端子一体接口，生产简单方便，将麦克风、喇叭、电源通讯端子三个配件插入各自对应端子即可使用。板子设计为防呆接口，三个端子之间不存在误插可能。插入操作过程请佩戴静电手套和静电手环，用合适力度确保连接器插入到位。在开工组装之前在打开真空静电包装袋。

### 存储条件

模块有真空包装，因此对存储条件要求不高，可储存在 < 40℃/90%RH 的非冷凝大气环境中。模块的潮湿敏感度等级MSL为3级，真空袋开封或者漏气后，请按照3级潮湿敏感度等级管控。

### 包装订购信息

<div align=center>表5 模块批量订购及包装信息</div>

<center>

产品型号 | 包装方式 | 每个托盘装模块数量 | 每包装模块数量 | 每箱装模块数量
:--: | :--: | :--: | :--: | :--:
CI-C22GS02S| 托盘+静电袋+纸箱 | 40pcs | 10个托盘共400pcs | 3袋共1200pcs

</center>

## 联系方式

如果您想购买模块或获取联系方式，请查看☞[样品和批量采购](../../样品和批量采购.md)。 

如果您想获取技术支持，请登录☞[启英泰伦语音AI平台](https://platform.chipintelli.com)  或☞[开发者论坛](https://bbs.chipintelli.com/)。